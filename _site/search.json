[
  {
    "objectID": "reults2/relatorio.html",
    "href": "reults2/relatorio.html",
    "title": "Análise Estatística de Fatores de Risco para Doença Coronária",
    "section": "",
    "text": "O dataset provém de um estudo que analisou 297 pacientes na Cleveland Clinic para avaliação da Doença Coronária;\nO experimento envolveu 3 estágios:\n\nTeste de esforço (protocolo de Bruce)\nCinefluoroscopia\nAngiografia coronária\nCintilografia com Tálio-201\n\n\n\n\nage\nsex\ncp : tipo de dor no peito\n\nAngina Típica: Atende a três critérios (localização atrás do osso do peito, provocada por esforço/estresse e aliviada por repouso).\nAngina Atípica: Atende a apenas dois desses critérios.\nDor Não Anginosa: Atende a apenas um ou nenhum dos critérios, sugerindo que a causa pode ser muscular ou gástrica (não cardíaca).\nAssintomático: O paciente não sente dor, mas o médico ainda assim solicitou os exames devido a outros fatores de risco (como idade ou histórico familiar).\n\nthalach : Frequência cardíaca máxima atingida antes da exaustão ou sintomas (no teste de esforço).\nexang : Indica se o paciente sentiu angina (dor) durante o exercício.\noldpeak : diferença entre a posição do segmento ST (ECG) no repouso e no pico do esforço (thalac) (quanto maior essa diferença, maior é a área do coração que sofre por falta de sangue)\nslope : Enquanto o oldpeak diz o quanto a linha afundou, o slope diz como ela se comporta logo após o afundamento. Existem três tipos principais de inclinação:\n\nValue 0: Upsloping (Ascendente): A linha afunda, mas sobe rápido. É comum em exercícios intensos e nem sempre indica doença grave.\nValue 1: Flat (Plano): A linha afunda e fica “reta”. É um sinal clássico e preocupante de isquemia.\nValue 2: Downsloping (Descendente): A linha afunda e continua descendo. É o sinal mais grave de todos, indicando que o coração está em alto sofrimento isquêmico. (mesmo após a interrupção do esforço)\n\nca : Número de vasos principais com depósitos de cálcio ou interrupções no fluxo.\n\n0: Nenhuma calcificação significativa (indício de artérias limpas)\n1, 2 o u 3: Indica que a doença está presente em um, dois ou três vasos principais.\n\nthal : Avalia se o sangue está chegando a todas as partes do coração durante o repouso e após o esforço.\n\n0 = Normal: O contraste se distribui uniformemente por todo o coração.\n1 = Fixed Defect (Defeito Fixo): Uma parte do coração não recebe o contraste nem no esforço, nem no repouso. Isso geralmente indica tecido morto (cicatriz de um infarto antigo).\n2 = Reversable Defect (Defeito Reversível): O coração parece normal em repouso, mas “falta sangue” em alguma região durante o esforço. Isso é o sinal clássico de isquemia ativa: a artéria está entupida, mas o tecido ainda está vivo e sofrendo.\n\ncondition (target)\ntrestbps : É a pressão arterial medida no momento da internação.\nfbs : Glicemia de Jejum é maior ou menor que 120mg/dl (binário)\nchol : nível total de colesterol no sangue.\nrestecg :\n\nValue 0 (Normal): O coração em repouso não apresenta irregularidades elétricas.\nValue 1 (Anormalidade de Onda ST-T): O coração já mostra sinais de sofrimento mesmo sem fazer esforço. É um sinal de alerta precoce.\nValue 2 (Hipertrofia Ventricular Esquerda): Indica que o músculo do coração está “inchado” (grosso), geralmente por ter que fazer muita força para bombear o sangue contra uma pressão alta crônica."
  },
  {
    "objectID": "reults2/relatorio.html#variáveis-analisadas",
    "href": "reults2/relatorio.html#variáveis-analisadas",
    "title": "Análise Estatística de Fatores de Risco para Doença Coronária",
    "section": "",
    "text": "age\nsex\ncp : tipo de dor no peito\n\nAngina Típica: Atende a três critérios (localização atrás do osso do peito, provocada por esforço/estresse e aliviada por repouso).\nAngina Atípica: Atende a apenas dois desses critérios.\nDor Não Anginosa: Atende a apenas um ou nenhum dos critérios, sugerindo que a causa pode ser muscular ou gástrica (não cardíaca).\nAssintomático: O paciente não sente dor, mas o médico ainda assim solicitou os exames devido a outros fatores de risco (como idade ou histórico familiar).\n\nthalach : Frequência cardíaca máxima atingida antes da exaustão ou sintomas (no teste de esforço).\nexang : Indica se o paciente sentiu angina (dor) durante o exercício.\noldpeak : diferença entre a posição do segmento ST (ECG) no repouso e no pico do esforço (thalac) (quanto maior essa diferença, maior é a área do coração que sofre por falta de sangue)\nslope : Enquanto o oldpeak diz o quanto a linha afundou, o slope diz como ela se comporta logo após o afundamento. Existem três tipos principais de inclinação:\n\nValue 0: Upsloping (Ascendente): A linha afunda, mas sobe rápido. É comum em exercícios intensos e nem sempre indica doença grave.\nValue 1: Flat (Plano): A linha afunda e fica “reta”. É um sinal clássico e preocupante de isquemia.\nValue 2: Downsloping (Descendente): A linha afunda e continua descendo. É o sinal mais grave de todos, indicando que o coração está em alto sofrimento isquêmico. (mesmo após a interrupção do esforço)\n\nca : Número de vasos principais com depósitos de cálcio ou interrupções no fluxo.\n\n0: Nenhuma calcificação significativa (indício de artérias limpas)\n1, 2 o u 3: Indica que a doença está presente em um, dois ou três vasos principais.\n\nthal : Avalia se o sangue está chegando a todas as partes do coração durante o repouso e após o esforço.\n\n0 = Normal: O contraste se distribui uniformemente por todo o coração.\n1 = Fixed Defect (Defeito Fixo): Uma parte do coração não recebe o contraste nem no esforço, nem no repouso. Isso geralmente indica tecido morto (cicatriz de um infarto antigo).\n2 = Reversable Defect (Defeito Reversível): O coração parece normal em repouso, mas “falta sangue” em alguma região durante o esforço. Isso é o sinal clássico de isquemia ativa: a artéria está entupida, mas o tecido ainda está vivo e sofrendo.\n\ncondition (target)\ntrestbps : É a pressão arterial medida no momento da internação.\nfbs : Glicemia de Jejum é maior ou menor que 120mg/dl (binário)\nchol : nível total de colesterol no sangue.\nrestecg :\n\nValue 0 (Normal): O coração em repouso não apresenta irregularidades elétricas.\nValue 1 (Anormalidade de Onda ST-T): O coração já mostra sinais de sofrimento mesmo sem fazer esforço. É um sinal de alerta precoce.\nValue 2 (Hipertrofia Ventricular Esquerda): Indica que o músculo do coração está “inchado” (grosso), geralmente por ter que fazer muita força para bombear o sangue contra uma pressão alta crônica."
  },
  {
    "objectID": "reults2/relatorio.html#modelo-com-todas-as-variáveis",
    "href": "reults2/relatorio.html#modelo-com-todas-as-variáveis",
    "title": "Análise Estatística de Fatores de Risco para Doença Coronária",
    "section": "Modelo com todas as variáveis",
    "text": "Modelo com todas as variáveis\n\nmodelo_completo &lt;- glm(condition~ ., data = treino, family = \"binomial\")\n\n\nsummary(modelo_completo)\n\n\nCall:\nglm(formula = condition ~ ., family = \"binomial\", data = treino)\n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -6.194972   3.665480  -1.690 0.091012 .  \nage         -0.026817   0.029325  -0.914 0.360473    \nsex1         1.751307   0.623152   2.810 0.004948 ** \ncp1          1.905287   0.923121   2.064 0.039021 *  \ncp2          0.321896   0.847290   0.380 0.704011    \ncp3          2.768984   0.864891   3.202 0.001367 ** \ntrestbps     0.014047   0.014133   0.994 0.320261    \nchol         0.005760   0.005651   1.019 0.308039    \nfbs1        -0.407723   0.701053  -0.582 0.560845    \nrestecg1     1.120803   3.359086   0.334 0.738634    \nrestecg2     0.261999   0.460966   0.568 0.569784    \nthalach     -0.011517   0.012639  -0.911 0.362196    \nexang1       0.337282   0.550815   0.612 0.540317    \noldpeak      0.649698   0.283217   2.294 0.021791 *  \nslope1       1.341601   0.600799   2.233 0.025547 *  \nslope2       0.402313   1.023407   0.393 0.694237    \nca1          2.575920   0.637209   4.043 5.29e-05 ***\nca2          3.119482   0.851992   3.661 0.000251 ***\nca3          2.982628   1.206518   2.472 0.013432 *  \nthal1       -0.336710   0.979476  -0.344 0.731023    \nthal2        1.486334   0.518928   2.864 0.004180 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 328.58  on 237  degrees of freedom\nResidual deviance: 141.26  on 217  degrees of freedom\nAIC: 183.26\n\nNumber of Fisher Scoring iterations: 6\n\n\nO AIC foi de 183.26.\nEmbora o modelo explique bem a variável alvo, é possível observar que a maioria das covariáveis não é estatísticamente significativa, segundo o teste de Wald.\nPara verificar isso, faremos um Teste de Razão de Verossimilhanças, verificando o impacto da retirada de cada variável.\n\npander::pander(  car::Anova(modelo_completo, type = \"III\", test = \"LR\")  )\n\n\nAnalysis of Deviance Table (Type III tests)\n\n\n\n\n\n\n\n\n \nLR Chisq\nDf\nPr(&gt;Chisq)\n\n\n\n\nage\n0.8384\n1\n0.3599\n\n\nsex\n8.776\n1\n0.003053\n\n\ncp\n20.58\n3\n0.0001287\n\n\ntrestbps\n0.9972\n1\n0.318\n\n\nchol\n1.046\n1\n0.3065\n\n\nfbs\n0.3411\n1\n0.5592\n\n\nrestecg\n0.4147\n2\n0.8127\n\n\nthalach\n0.8493\n1\n0.3568\n\n\nexang\n0.3705\n1\n0.5427\n\n\noldpeak\n5.789\n1\n0.01612\n\n\nslope\n5.689\n2\n0.05818\n\n\nca\n30.8\n3\n9.375e-07\n\n\nthal\n10.29\n2\n0.005832\n\n\n\n\n\nAqui é possível obervar que as variáveis que contribuem significativamente (ao nível de 5%) para o modelo são: sex, cp, oldpeak, slope, ca e thal.\nPara verificar o impacto no modelo ao retirar essas variáveis, faremos o Teste de Razão de Verossimilhanças entre o modelo completo e o modelo reduzido.\n\nmodelo_reduzido &lt;- glm( condition ~  sex + cp +\n                        oldpeak + slope + ca + thal,\n                        data = treino, \n                        family = \"binomial\"\n                    )\n\n\npander::pander(  anova(modelo_completo, modelo_reduzido, test = \"Chisq\")  )\n\n\nAnalysis of Deviance Table\n\n\n\n\n\n\n\n\n\nResid. Df\nResid. Dev\nDf\nDeviance\nPr(&gt;Chi)\n\n\n\n\n217\n141.3\nNA\nNA\nNA\n\n\n225\n146\n-8\n-4.728\n0.7863\n\n\n\n\n\nO p-valor foi de 0.7863, ou seja, não há evidências de que o modelo completo seja melhor que o modelo reduzido. Então prosseguiremos na análise usando o modelo reduzido."
  },
  {
    "objectID": "reults2/relatorio.html#modelo-reduzido",
    "href": "reults2/relatorio.html#modelo-reduzido",
    "title": "Análise Estatística de Fatores de Risco para Doença Coronária",
    "section": "Modelo reduzido",
    "text": "Modelo reduzido\n\npander::pander(  car::Anova(modelo_reduzido, type = \"III\", test = \"LR\")  )\n\n\nAnalysis of Deviance Table (Type III tests)\n\n\n\n\n\n\n\n\n \nLR Chisq\nDf\nPr(&gt;Chisq)\n\n\n\n\nsex\n7.552\n1\n0.005995\n\n\ncp\n33.87\n3\n2.114e-07\n\n\noldpeak\n8.84\n1\n0.002947\n\n\nslope\n7.529\n2\n0.02318\n\n\nca\n36.4\n3\n6.159e-08\n\n\nthal\n13.53\n2\n0.001152\n\n\n\n\n\nTodas variáveis contribuem significativamente para o modelo.\n\nAnalisando os coeficientes\n\nsummary(modelo_reduzido)\n\n\nCall:\nglm(formula = condition ~ sex + cp + oldpeak + slope + ca + thal, \n    family = \"binomial\", data = treino)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  -5.9413     1.0866  -5.468 4.55e-08 ***\nsex1          1.5013     0.5701   2.633 0.008457 ** \ncp1           1.9084     0.8790   2.171 0.029920 *  \ncp2           0.1321     0.8094   0.163 0.870380    \ncp3           2.8874     0.7625   3.787 0.000153 ***\noldpeak       0.7464     0.2675   2.790 0.005265 ** \nslope1        1.4200     0.5586   2.542 0.011027 *  \nslope2        0.3778     0.9772   0.387 0.699022    \nca1           2.4781     0.5834   4.248 2.16e-05 ***\nca2           2.7872     0.7884   3.535 0.000407 ***\nca3           3.0723     1.1399   2.695 0.007031 ** \nthal1        -0.4301     0.9152  -0.470 0.638360    \nthal2         1.6062     0.4905   3.275 0.001058 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 328.58  on 237  degrees of freedom\nResidual deviance: 145.99  on 225  degrees of freedom\nAIC: 171.99\n\nNumber of Fisher Scoring iterations: 6\n\n\nO AIC do modelo reduzido (171.99) foi menor que o do modelo completo, e a Deviance Residual foi aproximadamente igual. Ou seja, o modelo reduzido conseguiu explicar tão bem os dados quanto o completo.\n\npander::pander(  gerar_tabela_or(modelo_reduzido)  )\n\n\n\n\n\n\n\n\n\n\n\n\n \nOR\nIC_2.5\nIC_97.5\namplitude\np_valor\n\n\n\n\n(Intercept)\n0.0026\n3e-04\n0.0187\n0.0184\n0\n\n\nsex1\n4.487\n1.524\n14.54\n13.02\n0.0085\n\n\ncp1\n6.742\n1.257\n40.86\n39.6\n0.0299\n\n\ncp2\n1.141\n0.2326\n5.755\n5.522\n0.8704\n\n\ncp3\n17.95\n4.359\n89.08\n84.72\n2e-04\n\n\noldpeak\n2.109\n1.278\n3.68\n2.401\n0.0053\n\n\nslope1\n4.137\n1.427\n12.99\n11.56\n0.011\n\n\nslope2\n1.459\n0.2034\n9.701\n9.497\n0.699\n\n\nca1\n11.92\n3.986\n39.93\n35.94\n0\n\n\nca2\n16.24\n3.77\n83.96\n80.19\n4e-04\n\n\nca3\n21.59\n2.873\n261.3\n258.5\n0.007\n\n\nthal1\n0.6504\n0.1084\n4.116\n4.008\n0.6384\n\n\nthal2\n4.984\n1.94\n13.45\n11.51\n0.0011\n\n\n\n\n\nÉ possível observar que alguns coeficientes estimados são muito incertos (o modelo não conseguiu definir se a associação entre a respectiva variável e o target era positiva ou negativa) (o 1 está contido no IC de 95%);\nEssas variáveis foram : cp2, slope2 e thal1\nSegundo o teste de wald, essas variáveis não são significativas para o modelo.\nOutros coeficientes tinham IC com amplitude grande demais, como foi o caso de cp1, cp3, ca2, ca3,\nOu seja, o modelo não conseguiu estimar precisamente esses coeficientes\nUma possível motivação para isso é que essas variáveis categóricas possuem algumas classes subrepresentadas no dataset, dificultando a estimação dos parâmetros."
  },
  {
    "objectID": "reults2/relatorio.html#treinando-modelo-com-agrupamento-de-classes-subrepresentadas",
    "href": "reults2/relatorio.html#treinando-modelo-com-agrupamento-de-classes-subrepresentadas",
    "title": "Análise Estatística de Fatores de Risco para Doença Coronária",
    "section": "Treinando modelo com agrupamento de classes subrepresentadas",
    "text": "Treinando modelo com agrupamento de classes subrepresentadas\n\ncp :\n\ncom_dor : {0, 1, 2}\nsem_dor : {3}\n\nslope :\n\nasc : {0}\nnot_asc : {1, 2}\n\nca :\n\nzero : {0}\nnot_zero : {1, 2, 3}\n\nthal :\n\nnormal : {0}\nnot_normal : {1, 2}\n\n\n\nmodelo_agrupado &lt;- glm(condition ~ sex+ cp +\n                   oldpeak + slope + ca + thal, \n                 data = treino_agrupado, \n                 family = \"binomial\")\n\n\nsummary(modelo_agrupado)\n\n\nCall:\nglm(formula = condition ~ sex + cp + oldpeak + slope + ca + thal, \n    family = \"binomial\", data = treino_agrupado)\n\nCoefficients:\n                Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)      -2.1741     0.5627  -3.864 0.000112 ***\nsex1              1.1387     0.4984   2.285 0.022342 *  \ncp_sem dor        2.1247     0.4299   4.943 7.70e-07 ***\noldpeak           0.5708     0.2290   2.493 0.012669 *  \nslope_not_asc     0.9416     0.4819   1.954 0.050691 .  \nca_zero          -2.3326     0.4465  -5.224 1.75e-07 ***\nthal_not_normal   1.2461     0.4543   2.743 0.006092 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 328.58  on 237  degrees of freedom\nResidual deviance: 157.70  on 231  degrees of freedom\nAIC: 171.7\n\nNumber of Fisher Scoring iterations: 6\n\n\n\npander::pander(  gerar_tabela_or(modelo_agrupado)  )\n\n\n\n\n\n\n\n\n\n\n\n\n \nOR\nIC_2.5\nIC_97.5\namplitude\np_valor\n\n\n\n\n(Intercept)\n0.1137\n0.0346\n0.3199\n0.2853\n1e-04\n\n\nsex1\n3.123\n1.196\n8.564\n7.368\n0.0223\n\n\ncp_sem dor\n8.37\n3.71\n20.25\n16.54\n0\n\n\noldpeak\n1.77\n1.15\n2.836\n1.686\n0.0127\n\n\nslope_not_asc\n2.564\n1.004\n6.721\n5.717\n0.0507\n\n\nca_zero\n0.097\n0.0385\n0.2243\n0.1859\n0\n\n\nthal_not_normal\n3.477\n1.439\n8.636\n7.198\n0.0061\n\n\n\n\n\nAqui, é possível observar que os parâmetros estão mais estáveis e os odds ratios estão mais de acordo com os insights obtidos na EDA;\n\nTeste razão de verossimilhanças\n\npander::pander(  anova(modelo_reduzido, modelo_agrupado, test = \"Chisq\"),\n                 caption= \"Teste de Razão de Verossimilhanças entre o modelo reduzido e o agrupado\"  )\n\n\nTeste de Razão de Verossimilhanças entre o modelo reduzido e o agrupado\n\n\n\n\n\n\n\n\n\nResid. Df\nResid. Dev\nDf\nDeviance\nPr(&gt;Chi)\n\n\n\n\n225\n146\nNA\nNA\nNA\n\n\n231\n157.7\n-6\n-11.71\n0.06867\n\n\n\n\n\nAo nível de 5%, a diferença entre os dois modelos não é significativa. De acordo com o princípio da parcimônia e estabilidade dos parâmetros, prosseguiremos com a análise usando o modelo_agrupado.\n\n\nInterpretação dos coeficientes do modelo\n\nSer homem aumenta a chance de ter a doença em 3 vezes;\nSer assintomático aumenta a chance de ter a doença em 8 vezes;\nPara cada unidade de oldpeak, a chance de ter a doença aumenta em 77%;\nPacientes com inclinação não ascendente do segmento ST apresentam uma chance 2.5 vezes maior de ter a doença;\nNão ter vasos coloridos na fluoroscopia diminui a chance de ter a doença em 90%;\nPacientes com resultados de talassemia (thal) considerados não normais possuem 3.5 vezes mais chance de possuirem a doença;\n\n\n\nQualidade do ajuste do modelo\n\nperformance::performance_hosmer(modelo_agrupado)\n\n# Hosmer-Lemeshow Goodness-of-Fit Test\n\n  Chi-squared: 4.467\n           df: 8    \n      p-value: 0.813\n\n\nSummary: model seems to fit well.\n\n\nAo nível de significância de 5%, não foi possível rejeitar H_0, portanto não há evidências contra um mal ajuste do modelo.\n\n\nDiagnóstico do modelo\n\npar(mfrow = c(2, 2)) # Divide a tela em 2x2\nplot(modelo_agrupado)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1)) # Volta ao normal depois\n\n\nleverage &lt;- hatvalues(modelo_agrupado)\npreditos &lt;- predict(modelo_agrupado, type = \"response\")\n\n# Gerando o gráfico\nplot(preditos, leverage, \n     main = \"Leverage vs Predicted Values\",\n     xlab = \"Probabilidade Predita\",\n     ylab = \"Alavancagem (Leverage)\",\n    )\n\n# linha de corte (2p/n)\np &lt;- length(coef(modelo_agrupado))\nn &lt;- nrow(model.frame(modelo_agrupado))\nabline(h = 2 * p / n, col = \"red\", lty = 2)\n\n\n\n\n\n\n\n\n\n# Extraindo os resíduos studentizados (Pearson studentized residuals)\nres_stud &lt;- rstudent(modelo_agrupado)\n\n# Plotando\nplot(preditos, res_stud,\n     main = \"Resíduos Studentizados vs Preditos\",\n     xlab = \"Probabilidade Predita\",\n     ylab = \"Resíduos Studentizados\",\n)\n\n# Linhas de corte para Outliers\nabline(h = c(-2, 0, 2), col = c(\"red\", \"gray\", \"red\"), lty = c(2, 1, 2))\n\n\n\n\n\n\n\n\n\n# 1. Extrai o componente da deviance ao quadrado para cada observação\nd_quadrado &lt;- residuals(modelo_agrupado, type = \"deviance\")^2\npreditos &lt;- predict(modelo_agrupado, type = \"response\")\n\n# 2. Gera o gráfico\nplot(preditos, d_quadrado,\n     xlab = \"Valores preditos\",\n     ylab = \"d²\",\n     main = \"Componente da Deviance² vs Valores Preditos\",\n     pch = 1, col = \"black\")\n\n# 3. Adiciona a linha de corte sugerida (Chi-quadrado com 1 gl e 95% de confiança)\nabline(h = 3.84, linetype = \"dashed\", col = \"red\") # 3.84 é o valor exato para p &lt; 0.05\n\nWarning in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): \"linetype\"\nis not a graphical parameter\n\n\n\n\n\n\n\n\n\n\nfind(\"performance_hosmer\")\n\n[1] \"package:performance\""
  }
]